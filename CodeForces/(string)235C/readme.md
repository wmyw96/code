more details:
http://www.codeforces.com/contest/235/submission/3171200